# 反省书：同花顺PDF下载失败 (2026-01-02)

## 错误描述

用户要求下载同花顺的业绩公告PDF，我尝试多次失败后，给出了"同花顺有强力反爬保护"的结论。

**但用户截图清楚显示**：在浏览器中可以正常打开PDF，并能通过"另存为"保存到本地。

## 我的错误

### 1. 无依据推理（严重违规）
- 明明用户能正常访问和下载，我却说"有反爬机制"
- 完全违背了规则：**用户能访问 = Puppeteer也能访问，问题在代码不在网站**

### 2. 不认真分析问题
- 没有仔细检查Puppeteer的设置是否正确
- 没有尝试模拟用户的真实操作流程（从列表页点击进入PDF）
- 直接访问PDF URL而不是模拟人类操作路径

### 3. 推卸责任
- 说"同花顺有防下载机制"是在推卸责任
- 提出"替代方案"而不是解决问题本身

## 根本原因

用户截图显示：
1. 用户是从公告列表页面**点击链接**进入PDF页面
2. PDF在浏览器内置的PDF查看器中正常显示
3. 右键"另存为"可以保存

我的代码：
1. 直接构造PDF URL访问（跳过了正常的导航路径）
2. 没有正确设置Referer和会话
3. 没有使用浏览器的下载功能

## 正确做法

1. 先访问公告列表页面
2. 找到并点击公告链接（拟人操作）
3. 等待PDF在浏览器中加载完成
4. 使用Puppeteer触发浏览器的"另存为"功能
5. 或者使用page.pdf()方法（如果是内置PDF查看器）

## 承诺

1. 立即按照正确方法重新实现PDF下载
2. 不再对用户能正常访问的页面说"反爬机制"
3. 问题在代码时，承认代码问题而不是推卸给网站
