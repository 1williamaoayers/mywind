# 全部47个信息源定向采集功能实现计划

## 问题背景

用户订阅了股票后，系统需要从各信息源**针对性地采集**该股票的新闻。

**当前状态**：
- 系统共有 **47个信息源**（31个Puppeteer爬虫 + 16个HTTP API源）
- 定向采集功能只实现了 **9个**（富途、AAStocks、格隆汇、经济通、港交所、智通、同花顺、东方财富、新浪）
- 剩余 **38个信息源** 没有定向采集能力

---

## 信息源清单

### 已实现定向采集（9个）

| 信息源 | 类型 | 市场 | 状态 |
|--------|------|------|------|
| 富途 futu | Puppeteer | HK | ✅ |
| AAStocks | Puppeteer | HK | ✅ |
| 格隆汇 gelonghui | Puppeteer | HK/US/A | ✅ |
| 经济通 etnet | Puppeteer | HK | ✅ |
| 港交所 hkex | Puppeteer | HK | ✅ |
| 智通财经 zhitong | Puppeteer | HK/US | ✅ |
| 同花顺 ths | Puppeteer | A/HK | ✅ |
| 东方财富 eastmoney | Puppeteer | A/HK | ✅ |
| 新浪财经 sina | Puppeteer | 全 | ✅ |

### 待实现定向采集（38个）

#### Puppeteer爬虫（22个）

| 信息源 | 文件 | 市场 | 建议实现方式 |
|--------|------|------|-------------|
| 东财研报 | eastmoneyReport.js | A/HK | 搜索页 |
| 金十数据 | jin10.js | 全 | 搜索API |
| 每经新闻 | nbd.js | A | 搜索页 |
| 香港经济日报 | hket.js | HK | 个股页/搜索 |
| 信报财经 | hkej.js | HK | 搜索页 |
| 界面新闻 | jiemian.js | 全 | 搜索页 |
| 集微网 | jimei.js | 半导体 | 搜索页 |
| 36氪 | kr36.js | 科技 | 搜索页 |
| SEC | sec.js | US | CIK搜索 |
| SeekingAlpha | seekingalpha.js | US | 股票页 |
| 证券时报 | stcn.js | A | 搜索页 |
| 第一财经 | yicai.js | A | 搜索页 |
| 腾讯财经 | tencent.js | 全 | 搜索页 |
| Yahoo Finance | yahoo.js | US/HK | 股票页 |
| 微博热搜 | weibo.js | 全 | 关键词搜索 |
| 微信搜索 | wechatSearch.js | 全 | 关键词搜索 |
| 知乎 | zhihu.js | 全 | 关键词搜索 |
| 研报客 | yanbaoke.js | A/HK | 股票搜索 |
| 发现报告 | fxbaogao.js | A | 股票搜索 |
| 全球媒体 | globalMedia.js | 全 | 关键词搜索 |
| 港股通 | northbound.js | HK | 资金流向 |
| 淘股吧 | taoguba.js | A | 个股页 |

#### HTTP API源（16个）

| 信息源 | 来源 | 市场 | 建议实现方式 |
|--------|------|------|-------------|
| 巨潮资讯 | cninfo | A | 股票代码搜索 |
| 披露易 | hkexnews | HK | 股票代码搜索 |
| 上交所e互动 | sse_e | A | 股票代码搜索 |
| 深交所互动易 | szse_e | A | 股票代码搜索 |
| 雪球 | xueqiu | 全 | 股票搜索API |
| 慧博研报 | hibor | A | 股票搜索 |
| 财联社 | cls | 全 | 搜索API |
| 华尔街见闻 | wallstreet | 全 | 搜索API |
| 东财股吧 | guba | A | 个股股吧 |
| 同花顺热榜 | ths_hot | A | 股票搜索 |
| 企查查 | qichacha | 全 | 公司搜索 |
| 天眼查 | tianyancha | 全 | 公司搜索 |
| 英为财情 | investing | 全 | 股票搜索 |
| 人民银行 | pbc | 政策 | 关键词 |
| 发改委 | ndrc | 政策 | 关键词 |
| 证监会 | csrc | 政策 | 关键词 |

---

## 实现方案

### 核心思路

用"自动修复方法"对每个信息源进行分析，找出：
1. **个股页URL模式**（如 `futunn.com/stock/{code}-HK`）
2. **搜索页URL模式**（如 `gelonghui.com/search?keyword={name}`）
3. **正确的CSS选择器**

然后为每个信息源创建 `scrapeXxxForStock(stockCode, stockName)` 函数。

### 分批实施

#### 第一批：高价值港股源（7个）
- 香港经济日报、信报财经、东财研报、SEC、SeekingAlpha、Yahoo Finance、研报客

#### 第二批：A股源（8个）
- 每经新闻、界面新闻、36氪、证券时报、第一财经、巨潮资讯、上交所e互动、深交所互动易

#### 第三批：社交/舆情源（5个）
- 微博热搜、微信搜索、知乎、雪球、东财股吧

#### 第四批：其他（剩余）
- 全球媒体、港股通等

---

## 自动修复流程

对每个信息源执行：

1. **分析网站DOM结构**
```bash
node analyze-sites.js
```

2. **找到个股页/搜索页URL**
3. **更新选择器**
4. **创建 `scrapeXxxForStock` 函数**
5. **测试验证**

---

## 预估工作量

| 阶段 | 估计时间 | 信息源数 |
|------|----------|----------|
| 第一批 | 30分钟 | 7 |
| 第二批 | 30分钟 | 8 |
| 第三批 | 20分钟 | 5 |
| 第四批 | 20分钟 | 剩余 |
| 测试验证 | 20分钟 | 全部 |

**总计约2小时**

---

## 下一步

确认后开始第一批高价值港股源的定向采集功能实现。
